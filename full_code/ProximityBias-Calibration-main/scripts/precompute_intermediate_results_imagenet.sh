for MODEL in  "resnet50"
# "beit_large_patch16_512"  "beit_large_patch16_384"  "tf_efficientnet_l2_ns"  "tf_efficientnet_l2_ns_475"  "deit3_large_patch16_384_in21ft1k"  "convnext_xlarge_384_in22ft1k"  "beit_large_patch16_224"  "swinv2_large_window12to24_192to384_22kft1k"  "convnext_large_384_in22ft1k"  "deit3_huge_patch14_224_in21ft1k"  "swin_large_patch4_window12_384"  "swinv2_base_window12to24_192to384_22kft1k"  "vit_large_patch16_384"  "volo_d5_512"  "convnext_xlarge_in22ft1k"  "deit3_large_patch16_224_in21ft1k"  "volo_d5_448"  "swinv2_large_window12to16_192to256_22kft1k"  "tf_efficientnet_b7_ns"  "beit_base_patch16_384"  "volo_d4_448"  "deit3_base_patch16_384_in21ft1k"  "convnext_large_in22ft1k"  "convnext_base_384_in22ft1k"  "volo_d3_448"  "cait_m48_448"  "tf_efficientnet_b6_ns"  "swin_base_patch4_window12_384"  "tf_efficientnetv2_xl_in21ft1k"  "swin_large_patch4_window7_224"  "tf_efficientnetv2_l_in21ft1k"  "swinv2_base_window12to16_192to256_22kft1k"  "vit_large_r50_s32_384"  "dm_nfnet_f6"  "tf_efficientnet_b5_ns"  "volo_d5_224"  "cait_m36_384"  "volo_d2_384"  "vit_base_patch16_384"  "xcit_large_24_p8_384_dist"  "volo_d4_224"  "vit_large_patch16_224"  "convnext_base_in22ft1k"  "xcit_medium_24_p8_384_dist"  "dm_nfnet_f5"  "deit3_large_patch16_384"  "vit_base_patch8_224"  "xcit_large_24_p16_384_dist"  "convnext_small_384_in22ft1k"  "deit3_base_patch16_224_in21ft1k"  "dm_nfnet_f4"  "tf_efficientnetv2_m_in21ft1k"  "xcit_small_24_p8_384_dist"  "dm_nfnet_f3"  "tf_efficientnetv2_l"  "cait_s36_384"  "ig_resnext101_32x48d"  "xcit_medium_24_p16_384_dist"  "deit_base_distilled_patch16_384"  "volo_d3_224"  "xcit_large_24_p8_224_dist"  "tf_efficientnet_b8_ap"  "tf_efficientnet_b8"  "swin_base_patch4_window7_224"  "volo_d1_384"  "beit_base_patch16_224"  "deit3_huge_patch14_224"  "volo_d2_224"  "tf_efficientnet_b4_ns"  "tf_efficientnet_b7_ap"  "ig_resnext101_32x32d"  "xcit_small_24_p16_384_dist"  "xcit_small_12_p8_384_dist"  "deit3_base_patch16_384"  "xcit_medium_24_p8_224_dist"  "dm_nfnet_f2"  "cait_s24_384"  "tf_efficientnetv2_m"  "regnetz_e8"  "resnetrs420"  "vit_base_r50_s16_384"  "ecaresnet269d"  "tf_efficientnet_b7"  "xcit_large_24_p16_224_dist"  "resnetv2_152x4_bitm"  "xcit_small_24_p8_224_dist"  "deit3_small_patch16_384_in21ft1k"  "efficientnetv2_rw_m"  "tf_efficientnet_b6_ap"  "deit3_large_patch16_224"  "resnetrs350"  "xcit_small_12_p16_384_dist"  "eca_nfnet_l2"  "dm_nfnet_f1"  "swinv2_base_window16_256"  "seresnextaa101d_32x8d"  "convnext_small_in22ft1k"  "vit_base_patch16_224"  "resnest269e"  "resnetv2_152x2_bitm"  "regnetz_040h"  "resnetv2_101x3_bitm"  "resnetrs200"  "resnetrs270"  "vit_large_r50_s32_224"  "resmlp_big_24_224_in22ft1k"  "xcit_large_24_p8_224"  "seresnet152d"  "seresnext101d_32x8d"  "tf_efficientnetv2_s_in21ft1k"  "convnext_large"  "swsl_resnext101_32x8d"  "xcit_medium_24_p16_224_dist"  "vit_base_patch16_224_miil"  "swinv2_base_window8_256"  "tf_efficientnet_b5_ap"  "regnetz_040"  "xcit_small_12_p8_224_dist"  "swinv2_small_window16_256"  "seresnext101_32x8d"  "crossvit_18_dagger_408"  "ig_resnext101_32x16d"  "volo_d1_224"  "pit_b_distilled_224"  "tf_efficientnet_b6"  "convnext_tiny_384_in22ft1k"  "cait_xs24_384"  "regnetz_d8"  "regnetz_d8_evos"  "vit_small_r26_s32_384"  "tf_efficientnet_b3_ns"  "regnetz_d32"  "resnetv2_50x3_bitm"  "eca_nfnet_l1"  "resnet200d"  "swin_s3_base_224"  "regnety_080"  "tf_efficientnetv2_s"  "xcit_small_24_p16_224_dist"  "swinv2_small_window8_256"  "resnetv2_152x2_bit_teacher_384"  "convnext_base"  "xcit_small_24_p8_224"  "crossvit_15_dagger_408"  "resnest200e"  "tf_efficientnet_b5"  "efficientnetv2_rw_s"  "vit_small_patch16_384"  "deit3_base_patch16_224"  "swin_s3_small_224"  "xcit_tiny_24_p8_384_dist"  "xcit_medium_24_p8_224"  "regnety_064"  "resnetrs152"  "regnetv_064"  "regnety_160"  "twins_svt_large"  "resnet152d"  "resmlp_big_24_distilled_224"  "jx_nest_base"  "cs3se_edgenet_x"  "swinv2_cr_small_ns_224"  "cait_s24_224"  "deit3_small_patch16_384"  "efficientnet_b4"  "sequencer2d_l"  "mobilevitv2_200_384_in22ft1k"  "deit_base_distilled_patch16_224"  "dm_nfnet_f0"  "vit_base_patch32_384"  "swsl_resnext101_32x16d"  "xcit_small_12_p16_224_dist"  "xcit_small_12_p8_224"  "tf_efficientnet_b4_ap"  "swsl_resnext101_32x4d"  "swin_small_patch4_window7_224"  "regnetv_040"  "xception65"  "convnext_small"  "resnext101_64x4d"  "twins_svt_base"  "swinv2_cr_small_224"  "twins_pcpvt_large"  "xception65p"  "jx_nest_small"  "deit_base_patch16_384"  "deit3_small_patch16_224_in21ft1k"  "tresnet_m"  "tresnet_xl_448"  "regnety_040"  "tf_efficientnet_b4"  "resnet101d"  "mobilevitv2_175_384_in22ft1k"  "convnext_tiny_in22ft1k"  "xcit_large_24_p16_224"  "resnest101e"  "resnetv2_152x2_bit_teacher"  "resnetv2_50x1_bit_distilled"  "resnet152"  "swinv2_tiny_window16_256"  "sequencer2d_m"  "pnasnet5large"  "vit_relpos_base_patch16_clsgap_224"  "nfnet_l0"  "regnety_032"  "cs3edgenet_x"  "twins_pcpvt_base"  "ig_resnext101_32x8d"  "cs3sedarknet_x"  "xcit_medium_24_p16_224"  "regnetz_c16_evos"  "nasnetalarge"  "mobilevitv2_150_384_in22ft1k"  "levit_384"  "xcit_small_24_p16_224"  "eca_nfnet_l0"  "xcit_tiny_24_p16_384_dist"  "vit_relpos_medium_patch16_cls_224"  "xcit_tiny_24_p8_224_dist"  "regnetz_c16"  "crossvit_18_dagger_240"  "resnet61q"  "vit_relpos_base_patch16_224"  "gc_efficientnetv2_rw_t"  "vit_relpos_medium_patch16_224"  "poolformer_m48"  "pit_b_224"  "crossvit_18_240"  "xcit_tiny_12_p8_384_dist"  "tf_efficientnet_b2_ns"  "resnet51q"  "ecaresnet50t"  "efficientnetv2_rw_t"  "sequencer2d_s"  "mobilevitv2_200_in22ft1k"  "resnetv2_101x1_bitm"  "crossvit_15_dagger_240"  "coat_lite_small"  "mixer_b16_224_miil"  "vit_relpos_medium_patch16_rpn_224"  "convit_base"  "resnetrs101"  "tresnet_l_448"  "efficientnet_b3"  "vit_srelpos_medium_patch16_224"  "cs3darknet_x"  "convnext_tiny_hnf"  "crossvit_base_240"  "vit_base_patch16_rpn_224"  "cait_xxs36_384"  "swsl_resnext50_32x4d"  "ecaresnet101d"  "swin_s3_tiny_224"  "visformer_small"  "poolformer_m36"  "halo2botnet50ts_256"  "tresnet_xl"  "convnext_tiny"  "resnetv2_101"  "fbnetv3_g"  "pit_s_distilled_224"  "deit_base_patch16_224"  "resnetv2_50d_evos"  "xcit_small_12_p16_224"  "xception41p"  "tf_efficientnetv2_b3"  "mobilevitv2_175_in22ft1k"  "resnet101"  "xcit_tiny_24_p8_224"  "vit_small_r26_s32_224"  "ssl_resnext101_32x16d"  "resnetv2_50d_gn"  "tf_efficientnet_b3_ap"  "swinv2_tiny_window8_256"  "swinv2_cr_tiny_ns_224"  "cs3sedarknet_l"  "tresnet_m_448"  "twins_svt_small"  "halonet50ts"  "tf_efficientnet_b3"  "rexnet_200"  "resnetaa50"  "ssl_resnext101_32x8d"  "edgenext_small"  "lamhalobotnet50ts_256"  "crossvit_15_240"  "tf_efficientnet_lite4"  "tnt_s_patch16_224"  "levit_256"  "vit_large_patch32_384"  "tresnet_l"  "convnext_nano"  "mobilevitv2_150_in22ft1k"  "wide_resnet50_2"  "vit_relpos_small_patch16_224"  "convit_small"  "jx_nest_tiny"  "poolformer_s36"  "vit_small_patch16_224"  "tf_efficientnet_b1_ns"  "deit3_small_patch16_224"  "swin_tiny_patch4_window7_224"  "convmixer_1536_20"  "gernet_l"  "legacy_senet154"  "efficientnet_el"  "coat_mini"  "seresnext50_32x4d"  "gluon_senet154"  "xcit_tiny_12_p8_224_dist"  "deit_small_distilled_patch16_224"  "swsl_resnet50"  "resmlp_36_distilled_224"  "sebotnet33ts_256"  "lambda_resnet50ts"  "mobilevitv2_200"  "resnest50d_4s2x40d"  "vit_srelpos_small_patch16_224"  "pit_s_224"  "resnext50_32x4d"  "twins_pcpvt_small"  "haloregnetz_b"  "resmlp_big_24_224"  "crossvit_small_240"  "gluon_resnet152_v1s"  "resnest50d_1s4x24d"  "resnest50d"  "sehalonet33ts"  "cait_xxs24_384"  "xcit_tiny_12_p16_384_dist"  "gcresnet50t"  "ssl_resnext101_32x4d"  "gluon_seresnext101_32x4d"  "cs3darknet_l"  "gluon_seresnext101_64x4d"  "cs3darknet_focus_l"  "mobilevitv2_175"  "efficientnet_b3_pruned"  "ecaresnet101d_pruned"  "regnety_320"  "resmlp_24_distilled_224"  "gernet_m"  "vit_base_patch32_224"  "regnetz_b16"  "nf_resnet50"  "efficientnet_b2"  "gluon_resnext101_64x4d"  "ecaresnet50d"  "gcresnext50ts"  "cspresnext50"  "darknet53"  "resnet50d"  "darknetaa53"  "repvgg_b3"  "vit_small_patch32_384"  "mixnet_xl"  "gluon_resnet152_v1d"  "inception_resnet_v2"  "ecaresnetlight"  "edgenext_small_rw"  "xcit_tiny_24_p16_224_dist"  "gluon_resnet101_v1d"  "resnetv2_50"  "regnety_120"  "resnet50"  "mobilevitv2_150"  "seresnet33ts"  "resnetv2_50x1_bitm"  "gluon_resnext101_32x4d"  "ssl_resnext50_32x4d"  "poolformer_s24"  "rexnet_150"  "tf_efficientnet_b2_ap"  "efficientnet_el_pruned"  "gluon_resnet101_v1s"  "seresnet50"  "tf_efficientnet_el"  "regnetx_320"  "vit_base_patch16_224_sam"  "legacy_seresnext101_32x4d"  "repvgg_b3g4"  "tf_efficientnetv2_b2"  "inception_v4"  "dpn107"  "convmixer_768_32"  "skresnext50_32x4d"  "tf_efficientnet_b2"  "eca_resnet33ts"  "gcresnet33ts"  "resnet50_gn"  "cspdarknet53"  "dpn92"  "ens_adv_inception_resnet_v2"  "efficientnet_b2_pruned"  "gluon_resnet152_v1c"  "gluon_seresnext50_32x4d"  "resnetrs50"  "xception71"  "deit_small_patch16_224"  "regnetx_160"  "ecaresnet26t"  "levit_192"  "dpn131"  "tf_efficientnet_lite3"  "resmlp_36_224"  "cait_xxs36_224"  "gluon_xception65"  "ecaresnet50d_pruned"  "xcit_tiny_12_p8_224"  "mobilevitv2_125"  "gluon_resnet152_v1b"  "fbnetv3_d"  "resnext50d_32x4d"  "dpn98"  "gmlp_s16_224"  "regnetx_120"  "cspresnet50"  "gluon_resnet101_v1c"  "rexnet_130"  "eca_halonext26ts"  "vit_relpos_base_patch32_plus_rpn_256"  "hrnet_w64"  "tf_efficientnetv2_b1"  "xcit_tiny_24_p16_224"  "dla102x2"  "resmlp_24_224"  "repvgg_b2g4"  "gluon_resnext50_32x4d"  "resnext101_32x8d"  "tf_efficientnet_cc_b1_8e"  "ese_vovnet39b"  "pit_xs_distilled_224"  "gluon_resnet101_v1b"  "nf_regnet_b1"  "hrnet_w48"  "resnetblur50"  "eca_botnext26ts_256"  "tf_efficientnet_b1_ap"  "botnet26t_256"  "efficientnet_em"  "ssl_resnet50"  "dpn68b"  "resnet33ts"  "regnetx_080"  "res2net101_26w_4s"  "fbnetv3_b"  "halonet26t"  "lambda_resnet26t"  "coat_lite_mini"  "legacy_seresnext50_32x4d"  "regnetx_064"  "gluon_resnet50_v1d"  "xception"  "resnet32ts"  "mixnet_l"  "lambda_resnet26rpt_256"  "res2net50_26w_8s"  "hrnet_w40"  "hrnet_w44"  "wide_resnet101_2"  "tf_efficientnet_b1"  "gluon_inception_v3"  "repvgg_b2"  "efficientnet_b1"  "tf_mixnet_l"  "gluon_resnet50_v1s"  "dla169"  "tf_efficientnet_b0_ns"  "legacy_seresnet152"  "xcit_tiny_12_p16_224_dist"  "res2net50_26w_6s"  "xception41"  "dla102x"  "regnetx_040"  "resnest26d"  "levit_128"  "dla60_res2net"  "dla60_res2next"  "hrnet_w32"  "coat_tiny"  "vit_tiny_patch16_384"  "selecsls60b"  "cait_xxs24_224"  "legacy_seresnet101"  "repvgg_b1"  "tf_efficientnetv2_b0"  "tv_resnet152"  "mobilevit_s"  "res2next50"  "bat_resnext26ts"  "efficientnet_b1_pruned"  "dla60x"  "hrnet_w30"  "pit_xs_224"  "regnetx_032"  "res2net50_14w_8s"  "tf_efficientnet_em"  "hardcorenas_f"  "mobilevitv2_100"  "efficientnet_es"  "gmixer_24_224"  "dla102"  "gluon_resnet50_v1c"  "selecsls60"  "seresnext26t_32x4d"  "res2net50_26w_4s"  "resmlp_12_distilled_224"  "mobilenetv3_large_100_miil"  "tf_efficientnet_cc_b0_8e"  "resnet26t"  "rexnet_100"  "seresnext26ts"  "regnety_016"  "tf_inception_v3"  "xcit_nano_12_p8_384_dist"  "gcresnext26ts"  "hardcorenas_e"  "efficientnet_b0"  "tinynet_a"  "legacy_seresnet50"  "cs3darknet_m"  "tv_resnext50_32x4d"  "seresnext26d_32x4d"  "repvgg_b1g4"  "gluon_resnet50_v1b"  "adv_inception_v3"  "res2net50_48w_2s"  "coat_lite_tiny"  "tf_efficientnet_lite2"  "eca_resnext26ts"  "inception_v3"  "hardcorenas_d"  "tv_resnet101"  "densenet161"  "tf_efficientnet_cc_b0_4e"  "mobilenetv2_120d"  "densenet201"  "cs3darknet_focus_m"  "mixnet_m"  "poolformer_s12"  "selecsls42b"  "xcit_tiny_12_p16_224"  "resnet34d"  "legacy_seresnext26_32x4d"  "tf_efficientnet_b0_ap"  "hardcorenas_c"  "dla60"  "crossvit_9_dagger_240"  "tf_mixnet_m"  "regnetx_016"  "convmixer_1024_20_ks9_p14"  "gernet_s"  "skresnet34"  "tf_efficientnet_b0"  "ese_vovnet19b_dw"  "resnext26ts"  "hrnet_w18"  "resnet26d"  "resmlp_12_224"  "tf_efficientnet_lite1"  "mixer_b16_224"  "tf_efficientnet_es"  "densenetblur121d"  "hardcorenas_b"  "levit_128s"  "mobilenetv2_140"  "repvgg_a2"  "xcit_nano_12_p8_224_dist"  "regnety_008"  "dpn68"  "tv_resnet50"  "mixnet_s"  "vit_small_patch32_224"  "vit_tiny_r_s16_p8_384"  "hardcorenas_a"  "densenet169"  "mobilenetv3_large_100"  "tf_mixnet_s"  "mobilenetv3_rw"  "mobilevitv2_075"  "densenet121"  "tf_mobilenetv3_large_100"  "resnest14d"  "efficientnet_lite0"  "vit_tiny_patch16_224"  "xcit_nano_12_p16_384_dist"  "semnasnet_100"  "resnet26"  "regnety_006"  "repvgg_b0"  "fbnetc_100"  "resnet34"  "hrnet_w18_small_v2"  "mobilenetv2_110d"  "regnetx_008"  "efficientnet_es_pruned"  "tinynet_b"  "edgenext_x_small"  "tf_efficientnet_lite0"  "legacy_seresnet34"  "tv_densenet121"  "mnasnet_100"  "mobilevit_xs"  "dla34"  "gluon_resnet34_v1b"  "pit_ti_distilled_224"  "deit_tiny_distilled_patch16_224"  "vgg19_bn"  "spnasnet_100"  "regnety_004"  "ghostnet_100"  "crossvit_9_240"  "xcit_nano_12_p8_224"  "regnetx_006"  "vit_base_patch32_224_sam"  "tf_mobilenetv3_large_075"  "vgg16_bn"  "crossvit_tiny_240"  "tv_resnet34"  "swsl_resnet18"  "convit_tiny"  "skresnet18"  "semnasnet_075"  "mobilenetv2_100"  "pit_ti_224"  "ssl_resnet18"  "regnetx_004"  "vgg19"  "resnet14t"  "hrnet_w18_small"  "xcit_nano_12_p16_224_dist"  "resnet18d"  "tf_mobilenetv3_large_minimal_100"  "deit_tiny_patch16_224"  "lcnet_100"  "mixer_l16_224"  "vit_tiny_r_s16_p8_224"  "legacy_seresnet18"  "vgg13_bn"  "vgg16"  "tinynet_c"  "edgenext_xx_small"  "gluon_resnet18_v1b"  "vgg11_bn"  "regnety_002"  "mobilevitv2_050"  "xcit_nano_12_p16_224"  "vgg13"  "resnet18"  "vgg11"  "mobilevit_xxs"  "lcnet_075"  "regnetx_002"  "resnet10t"  "tf_mobilenetv3_small_100"  "dla60x_c"  "mobilenetv3_small_100"  "tinynet_d"  "mnasnet_small"  "dla46x_c"  "mobilenetv2_050"  "tf_mobilenetv3_small_075"  "mobilenetv3_small_075"  "dla46_c"  "lcnet_050"  "tf_mobilenetv3_small_minimal_100"  "tinynet_e"  "mobilenetv3_small_050"  


do
python pytorch-image-models/precompute_intermediate_results.py \
    --data_dir "/home/miao/datasets/ImageNet" \
    --dataset "imagenet" \
    --model $MODEL \
    --output_dir "intermediate_output/imagenet" \
    --split "val" 
done